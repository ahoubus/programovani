class_name Player

extends CharacterBody2D

@export var speed = 300
@export var dash_speed = 1000
@export var health = 100
@export var damage = 10
@export var points = 0
var dashing = false
var can_dash = true

static var instance: Player

func _init() -> void:
	instance = self

# Called when the node enters the scene tree for the first time.
func _ready() -> void:
	pass # Replace with function body.

# Called every frame. 'delta' is the elapsed time since the previous frame.
func _physics_process(delta: float) -> void:
	if can_dash == true:
		if Input.is_action_pressed("dash"):
			$Can_dash_timer.start()
			$Dashing_timer.start()
			dashing = true
			can_dash = false

	
	var input = Input.get_vector("left", "right", "up", "down")
	if dashing:
		velocity = input * dash_speed
	else:
		velocity = input * speed
	
	move_and_slide()

func _process(delta: float) -> void:
	$Sprite2D.rotation = position.angle_to_point(get_global_mouse_position()) + PI / 2
	$Healthbar.size.x = remap(health, 0, 100, 0, 44)
	if health <= 0:
		queue_free()
		
func _on_dashing_timer_timeout() -> void:
	dashing = false


func _on_can_dash_timer_timeout() -> void:
	can_dash = true
